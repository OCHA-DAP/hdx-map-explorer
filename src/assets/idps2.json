{
  "name": "#HDXSprint Displacement Tracking Matrix",
  "id": "2",
  "description": "IDPs at adm1. Bubbles + bar chart",
  "url": "http://data.hdx.rwlabs.org/dataset/2d3c4e22-4603-45b8-b231-82cc2d45abf2/resource/c51b69a0-5f2c-4598-aded-dc63095380fe/download/hdxsprint-dtm-adm1.csv",
  "map": {
    "shapefile": {
      "url": "/assets/json/gadm28_LCR_adm1.geojson",
      "joinColumn": "NAME_1"
    },
    "layers": [
      {
        "type":"bubble",
        "joinColumn": "#adm1+name",
        "valueColumn": "#affected+sum+displaced",
        "threshold": [1000,10000,50000,100000,500000,1000000],
        "colors": ["#c7e9c0", "#a1d99b", "#74c476", "#41ab5d", "#238b45", "#005a32"],
        "operations": [
           {
            "type": "select",
            "options": {
              "column": "#affected+type",
              "operator": "=",
              "value": "idp"
            }
          },
          {
            "type": "select",
            "options": {
              "column": "#date",
              "operator": ">=",
              "value": "2015-01-01"
            }
          },
          {
            "type": "sum",
            "options": {
              "groupByColumn": "#adm1+name",
              "avgColumn": "#affected+displaced"
            }
          }
        ]
      }
    ]
  },
  "charts": [
    {
      "name": "Bar chart by date",
      "options": {
        "data": {
          "x": "#date+bin",
          "type": "bar"
        },
        "axis": {
          "x": {
            "type": "timeseries",
            "tick": {
              "format": "%B %Y",
              "rotate": 30
            },
            "height": 60
          }
        }
      },
      "nextIndex": "02",
      "operations": [
        {
          "type": "select",
          "options": {
            "column": "#affected+type",
            "operator": "=",
            "value": "idp"
          }
        },
        {
          "type": "sort",
          "options": {
            "columns": "#date+bin"
          }
        },
        {
          "type": "sum",
          "options": {
            "groupByColumn": "#date+bin",
            "avgColumn": "#affected+displaced"
          }
        }
      ]
    }
  ]
}
